@model LVMini.ViewModels.RegisterViewModel
@{
    ViewData["Title"] = "Register";
}
<head>

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

    <link rel="stylesheet" href="~/css/Style.css" />
    <link rel="icon" type="image/x-icon" href="~/images/iconr.png" />
    <link rel="stylesheet" href="~/css/site.css">
</head>

<h2>Register</h2>

<div class="Register">

    @using (Html.BeginForm("Register", "Accounts", FormMethod.Post))
    {

        <div>
            <div>
                @Html.LabelFor(model => model.Username)
                <div>
                    <input type="text" id="Username" onkeyup="CheckValid(this.value)" placeholder="Choose An Username" />
                    @Html.ValidationMessageFor(model => model.Username)
                </div>
            </div>
            <div>
                @Html.LabelFor(model => model.Email)
                <div>
                    <input type="text" id="Email" placeholder="Example@mail.com" />
                    @*<input type="button" id="Click" value="Click" />*@
                    <span id="errmsg"></span>
                    @Html.ValidationMessageFor(model => model.Email)
                </div>
            </div>
            <div>
                @Html.LabelFor(model => model.Firstname)
                <div>
                    @Html.TextBoxFor(model => model.Firstname, new { @class = "RegFields", @placeholder = "Enter Your First Name" })
                    @Html.ValidationMessageFor(model => model.Firstname)
                </div>
            </div>
            <div>
                @Html.LabelFor(model => model.Lastname)
                <div>
                    @Html.TextBoxFor(model => model.Lastname, new { @class = "RegFields", @placeholder = "Enter Your Last Name" })
                    @Html.ValidationMessageFor(model => model.Lastname)
                </div>
            </div>
            <div>
                @Html.LabelFor(model => model.Password)
                <div>
                    @Html.TextBoxFor(model => model.Password, new { @class = "RegFields", @placeholder = "Enter Your Password" })
                    @Html.ValidationMessageFor(model => model.Password)
                </div>
            </div>
            <div>
                @Html.LabelFor(model => model.ConfirmPassword)
                <div>
                    @Html.TextBoxFor(model => model.ConfirmPassword, new { @class = "RegFields", @placeholder = "Repeat Your Password" })
                    @Html.ValidationMessageFor(model => model.ConfirmPassword)

                </div>
            </div>
            <div>
                <input type="submit" id="Click" value="Register"/>
                <input type="button" value="Cancel" id ="Cancel" onclick="location.href='@Url.Action("Index","Home")';" />
            </div>
        </div>
    }
</div>

<script type="text/javascript">
    var url = '@Url.Action("CheckUser", "Accounts")';
    var emailurl = '@Url.Action("CheckEmail","Accounts")';
    var expr = /^([\w-\.]+)@@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;

    function CheckValid(name) {

        $.ajax({
            url: url,
            contentType: "application/json",
            data: {name: name},
            success: function(response) {
                console.log(response);
            },
            error: function(data) {
                console.log(data);
            }
        });
    }
    function CheckEmail(email) {
        $.ajax({
            url: emailurl,
            contentType: "application/json",
            data: { email: email },
            success: function (response) {
                console.log(response);
            },
            error: function (data) {
                console.log(data);
            }
        });
    }
//Validate E-mail
    function ValidateEmail(email) {
        // Validate Email Format
        return expr.test(email);
    };

        $("#Click").live("click", function () {
            if (!ValidateEmail($("#Email").val())) {
                $("#errmsg").html("Invalid Email Address!").show().fadeOut("slow");
                return false;
        }
            else {
                $("#errmsg").html("Valid Email Address!!").show().fadeOut("slow");
                return false;
        }
    });

</script>